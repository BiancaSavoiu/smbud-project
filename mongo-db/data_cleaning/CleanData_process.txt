//FROM COMMAND LINE IN MONGOSH
//dataset = name of the collection of the database we are working with
use dataset

//Remove fields from all documents
db.dataset.updateMany(
   { },
   { $unset: { year: "" } }
)

db.dataset.updateMany(
   { },
   { $unset: { n_citation: "" } }
)

db.dataset.updateMany(
   { },
   { $unset: { pdf: "" } }
)

//Done for title, page_start, page_end, doi, volume, issue, isbn, abstract, issn
db.dataset.updateMany(
   { volume : {$eq : ""} }, 
   { $unset: {volume: ""}}
)

//FROM THE FILTERING OPTION
//Clean the data
{$and: [{ title: { $not: { $regex: '^[1-9]' } }},{ page_start: { $regex: '^[0-9]+$' }},{ page_end: { $regex: '^[0-9]+$' }}, {volume : {$not : { $eq : "null"}}}, {abstract: {$not : {$eq : null}}}, {references: {$not : {$eq : null}}}, {keywords: {$not : {$eq : null}}]}

//select only documents with the raw value present
{venue.raw : {$exists : true}}

//OPERATIONS TO CLEAN FIELDS AND TYPE
//Export the data in .csv filtering only the fields we want (delete all the fields from venue, leaving only 'raw')
//With vim substitute in the csv the 'venue.raw' with 'venue' -> :%s/venue.raw/venue/g
//When reimporting the data from the csv change the type of the fields: Integer32 for page_start and page_end
